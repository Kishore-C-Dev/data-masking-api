masking:
  # Namespace to type mappings
  # When xmlns contains the pattern, the PayloadType becomes XML_<PATTERN_UPPERCASE>
  # Example: pattern "pain.013" -> PayloadType.XML_PAIN_013
  namespaceMappings:
    - pattern: "pain.013"
    - pattern: "pain.014"
    - pattern: "camt.035"
    - pattern: "camt.054"

  rules:
    # Generic XML rules (fallback for non-namespaced XML)
    - type: "xml"
      attributes:
        - xpath: "//AccountNumber"
        - xpath: "//BankAccount/Number"
        - xpath: "//CreditCard/CardNumber"
        - xpath: "//Transaction/AccountId"

    # ISO 20022 pain.013 (Creditor Payment Activation Request)
    - type: "xml_pain_013"
      attributes:
        - xpath: "//ns:CdtrPmtActvtnReq/ns:PmtInf/ns:CdtrAcct/ns:Id/ns:IBAN"
        - xpath: "//ns:DbtrAcct/ns:Id/ns:IBAN"
        - xpath: "//ns:CdtrAcct/ns:Id/ns:Othr/ns:Id"

    # ISO 20022 pain.014 (Creditor Payment Activation Request Status Report)
    - type: "xml_pain_014"
      attributes:
        - xpath: "//ns:OrgnlPmtInfAndSts/ns:OrgnlPmtInfId"
        - xpath: "//ns:CdtrAcct/ns:Id/ns:IBAN"

    # ISO 20022 camt.035 (Proprietary Format Investigation)
    - type: "xml_camt_035"
      attributes:
        - xpath: "//ns:Case/ns:Id"
        - xpath: "//ns:Undrlyg/ns:Initn/ns:OrgnlGrpInf/ns:OrgnlMsgId"

    # ISO 20022 camt.054 (Bank to Customer Debit Credit Notification)
    - type: "xml_camt_054"
      attributes:
        - xpath: "//ns:BkToCstmrDbtCdtNtfctn/ns:Ntfctn/ns:Acct/ns:Id/ns:IBAN"
        - xpath: "//ns:RltdAcct/ns:Id/ns:IBAN"
        - xpath: "//ns:Ntry/ns:NtryDtls/ns:TxDtls/ns:RltdPties/ns:DbtrAcct/ns:Id/ns:IBAN"
        - xpath: "//ns:Ntry/ns:NtryDtls/ns:TxDtls/ns:RltdPties/ns:CdtrAcct/ns:Id/ns:IBAN"

    # JSON-based masking rules
    - type: "json"
      attributes:
        - jsonpath: "$.account.accountNumber"
        - jsonpath: "$.customer.bankAccount"
        - jsonpath: "$.payment.sourceAccount"
        - jsonpath: "$.payment.destinationAccount"
        - jsonpath: "$.user.creditCard"
        - jsonpath: "$.user.bankAccountNumber"
        - jsonpath: "$.transaction.accountId"

    # Fixed-length string masking rules - MTSFTR format (starts with *FTR)
    - type: "mtsftr"
      attributes:
        - start: 10
          end: 26
        - start: 50
          end: 66
        - start: 100
          end: 116

    # Fixed-length string masking rules - MTSADM format (starts with *ADM)
    - type: "mtsadm"
      attributes:
        - start: 15
          end: 31
        - start: 60
          end: 76

    # Fixed-length string masking rules - MFFIXED format (starts with ACAI)
    - type: "mffixed"
      attributes:
        - start: 20
          end: 36
        - start: 80
          end: 96
